# <mark>LAS@tokyo_開発のため、不完全かつ不正確な段階です</mark>
東京都新宿区🗼におけるLas点群データを用いた解析を行いました。
データ取得元は、[デジタルツインプロジェクト](https://info.tokyo-digitaltwin.metro.tokyo.lg.jp/)です。
## 点群データとは
> 点群データは、X,Y,Zで表される三次元座標で構成された、点の集合体です。
>単に点群と呼ばれる場合もあります。データの形式は、.txt、.lasなど複数存在しています。
>測定器から取り込まれた物体や地形などの形状を表すデータは、無数の点で構成された点群データという形で記録されることにより、PCなどで扱うことができるようになります。   
[株式会社レックス 点群データと3Dモデル化の基本を分かりやすく解説!](https://www.rex-rental.jp/feature/1120/note/Point_cloud_data_3D_model)

# <mark >点群データの解析における具体的内容</mark>
本研究では、点群データを元にした外壁やオブジェクトの認識について扱っています。点群データは、レーザーを照射し帰ってきた光を元に点を生成しているため影になっている部分などは、以下の図のように精確にプロットすることができないという課題があります。そこで、プロットが精確でない部分での壁や地面を形成していると認識する精度を上げようと考え、本分析をスタートいたしました。

![東京都新宿区におけるビル下部の点が生成されていない部分](https://github.com/yut0takagi/LasTokyo/blob/main/pictures/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202024-12-26%2010.25.50.png)

1. **座標化**   
    las形式で保存されたデータは保存されている数値をそのまま座標として利用することができないため、座標へと変更します。計算式は以下の通りです。   
    > $ X = Raw_x *X_{scale} + X_{offset} $   
    > $ Y = Raw_y *Y_{scale} + Y_{offset} $   
    > $ Z = Raw_z *Z_{scale} + Z_{offset} $   
2. **データの座標系の設定と可視化**    
    3Dプロットを実現します。それにより、調査対象となるオブジェクトや範囲の認識が容易になります。3Dプロットには、
3. **近隣点の認識の計算**    
    各点からの際近隣と言える点を取得します。

***
# <mark >具体的な実装方法</mark>
## LASデータのバージョン確認
本解析でサポートできるバージョンはVer1.2であるため、以下の方法で確認できます。
```Python
Object.GetVersion()
```
## ポイント座標データの取得
Las データには、整数値int32しか持っていないため、座標として利用できるようにします。
```Python
Object.GetCoordinates()
```
## 概形の把握1(matplotlib.pyplotによる出力)
matplotlibによる概形の把握を行います。3Dプロットを操作することはできないですが、処理が軽いため、大規模データにおける概形の把握を目的とした描画にご利用ください。
```Python
Object.getPlot()
```
## 概形の把握2 ()
## 最近隣点の取得
近隣と言える点の座標を取得することで、その点間の距離や傾きを取得する。具体的な手法としては、線形探索法ではなくkd木というものを利用した。本データはx,y,z座標系からなるため3次元データに該当する。そこで、全探索を行う場合、近隣ですらない点でも確認することとなる。そのため、k-近傍法を用いて分類した上でそのセグメント内においてユーグリッド距離を計測し近隣点を取得した。

## 